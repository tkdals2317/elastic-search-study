이번 절에서는 엘라스틱서치의 기본 구조를 개괄적으로 살펴보고 기본적인 용어들을 알아본다.

![2.2 엘라스틱서치 인덱스와 샤드](https://github.com/tkdals2317/elastic-search-study/assets/49682056/f65458a3-e749-4a4d-986e-35ff456305a3)

- **문서(document)** : **엘라스틱서치가 저장하고 색인을 생성하는 JSON 문서**를 뜻한다.
- **인덱스** : **문서를 모아 놓은 단위가 인덱스**다. 클라이언트는 이 인덱스를 단위로 엘라스틱서치에 검색을 요청하게 된다.
- **샤드 :** 인덱스는 그 내용을 여러 샤드로 분리하여 **분산 저장**한다. 또한 엘라스틱서치는 고가용성을 제공하기 위해 샤드의 내용을 복제해 둔다. **원본 역할을 담당하는 샤드를 주 샤드(primary shard)**라고 하고 **복제본을 복제본 샤드(replication shard)**라고 한다.
- _id : 인덱스 내 문서에 부여되는 고유한 구분자다. 인덱스 이름과 _id 이름의 조합은 엘라스틱서치 클러스터 내에서 고유하다.
- **타입** : 엘라스틱서치는 과거에 하나의 인덱스 안에 있는 여러 문서를 묶어서 타입이라는 논리단위로 나눴다. 하지만 엘라스틱서치 6부터는 인덱스 하나에 타입 하나만 둘 수 있게 제한했고, 7버전 부터는 여러 API 에서 타입을 명시하는 부분들이 지원 중단(deprecated)됐다. 타입 이름이 들어가야 할 자리에는 기본값인 _doc이 들어간 API를 사용해야 한다. 사용할 일 X

![그림 2.3 엘라스틱서치 클러스터(빨간 색이 주 샤드, 검은 색이 복제본 샤드)](https://github.com/tkdals2317/elastic-search-study/assets/49682056/24e4e7ed-bf15-4ec9-835a-a97a1d4b4d6b)



- **노드** : **엘라스틱서치 프로세스 하나**가 **노드 하나**를 구성한다. 엘라스틱서치 노드 하나는 **여러개의 샤드**를 가진다. **엘라스틱서치는 고가용성을 제공하기 위해 같은 종류의 샤드를 같은 노드에 배치하지 않는다**. 0번 주 샤드와 복제본 샤드는 같은 노드에 배치되지 않는다. 0번 복제본 샤드 두 개가 같은 노드에 배치되지도 않는다.
- 클러스터 : 이러한 엘라스틱서치 노드가 여러 개가 모여 하나의 클러스터를 구성한다.
- 노드의 역할 : 엘라스틱서치의 노드는 **데이터 노드**, **마스터 노드**, **조정 노드** 등 여러 역할 중 하나 이상의 역할을 맡아 수행한다.
    - 데이터 노드 : 샤드를 보유하고 샤드에 실제 읽기와 쓰기 작업을 수행하는 노드
    - 마스터 노드 : 클러스터를 관리하는 중요한 역할을 하는 노드, 마스터 노드는 마스터 후보 노드 중 1대가 선출된다.
    - 조정 노드 : 클라이언트 요청을 받아서 데이터 노드에 요청을 분배하고 클라이언트에게 응답을 돌려주는 노드